---
title: "TRABAJO DIPLOMADO - Análisis Exploratorio"
author: "Marco Antonio Imués Figueroa"
date: "07 de mayo de 2022"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo =TRUE)

library(stats)
library(ggplot2)
library(psych)
library(readxl)
```

## *Variación de las variables de estudio*

# Presentación de tablas de datos

```{r}
Chlorella <- read_excel("Chlorella.xlsx", na="NA")
Chlorella_mod <- na.omit(Chlorella_mod)
Chlorella_mod$FBR <- as.factor(Chlorella_mod$FBR)
Chlorella_mod$Ciclo <- as.factor(Chlorella_mod$Ciclo)
Chlorella_mod$Dias <- as.factor(Chlorella_mod$Dias)
Chlorella_mod$Muestra <- as.factor(Chlorella_mod$Muestra)
summary(Chlorella_mod)
str(Chlorella_mod)
table(Chlorella_mod$FBR)
table(Chlorella_mod$Ciclo)
table(Chlorella_mod$Dias)
table(Chlorella_mod$Muestra)
```

# Exploración gráfica: Histogramas

```{r}
Chlorella_mod <- data.frame(Chlorella_mod)
ggplot(Chlorella_mod, aes(x=Densidad)) +
  geom_histogram(aes(color=FBR), bins=10) + 
  labs(title = "Figura 1. Densidad celular (cel/ml)", y="Frecuencia")

ggplot(Chlorella_mod, aes(x=TCS)) +
  geom_histogram(aes(color=FBR), bins=6, na.rm = TRUE) +
  labs(title = "Figura 2. Tasa de crecimiento simple (TCS)", y="Frecuencia")

ggplot(Chlorella_mod, aes(x=Temperatura)) +
  geom_histogram(aes(color=FBR), bins=10) +
  labs(title = "Figura 3. Temperatura promedio diario (°C)", y="Frecuencia")

ggplot(Chlorella_mod, aes(x=CO2)) +
  geom_histogram(aes(color=FBR), bins=10) +
  labs(title = "Figura 4. CO2 (mg/L)", y="Frecuencia")

ggplot(Chlorella_mod, aes(x=OD)) +
  geom_histogram(aes(color=FBR), bins=10) +
  labs(title = "Figura 5. Oxígeno disuelto (mg/L)", y="Frecuencia")
```

# Exploración gráfica: Diagrama de cajas y bigotes

```{r}
ggplot(Chlorella_mod, aes(x=FBR, y=Densidad)) +
  geom_boxplot(aes(fill=Ciclo)) +
  labs(title = "Figura 6. Densidad (cel/ml) agrupado por FBR y Ciclo", y="Densidad (cel/ml)")

ggplot(Chlorella_mod, aes(x=FBR, y=TCS)) +
  geom_boxplot(aes(fill=Ciclo), na.rm=TRUE) +
  labs(title = "Figura 7. Tasa de crecimiento simple (TCS) agrupado por FBR y Ciclo", y="TCS")

ggplot(Chlorella_mod, aes(x=FBR, y=Temperatura)) +
  geom_boxplot(aes(fill=Ciclo)) +
  labs(title = "Figura 8. Temperatura (°C) agrupado por FBR y Ciclo", y="Temperatura (°C)")

ggplot(Chlorella_mod, aes(x=FBR, y=CO2)) +
  geom_boxplot(aes(fill=Ciclo)) +
  labs(title = "Figura 9. CO2 (mg/L) agrupado por FBR y Ciclo", y="CO2 (mg/L)")

ggplot(Chlorella_mod, aes(x=FBR, y=OD)) +
  geom_boxplot(aes(fill=Ciclo)) +
  labs(title = "Figura 10. Oxígeno disuelto (mg/L) agrupado por FBR y Ciclo", y="OD (mg/L)")

```

# Exploración gráfica: Distribución y relación entre variables

```{r}
ggplot(Chlorella_mod, aes(x=Temperatura, y=Densidad)) +
  geom_point(aes(color=FBR)) +
  geom_smooth(span=0.2) +
  labs(title = "Figura 11. Relación entre Temperatura (°C) y Densidad (cel/ml) agrupadas por FBR")

ggplot(Chlorella_mod, aes(x=CO2, y=Densidad)) +
  geom_point(aes(color=FBR)) +
  geom_smooth(span=0.2) +
  labs(title = "Figura 12. Relación entre CO2 (mg/L) y Densidad (cel/ml) agrupadas por FBR")

ggplot(Chlorella_mod, aes(x=OD, y=Densidad)) +
  geom_point(aes(color=FBR)) +
  geom_smooth(span=0.2) +
  labs(title = "Figura 13. Relación entre Oxígeno disuelto (mg/l) y Densidad (cel/ml) agrupadas por FBR")

```

# Exploración gráfica: Función de densidad y Función de probabilidad acumulada

```{r}
plot(density(Chlorella_mod$Densidad), main = "Figura 13. Función de densidad para la variable Densidad (cel/ml)", y="Densidad")
plot(density(Chlorella_mod$Temperatura), main = "Figura 14. Función de densidad para la variable Temperatura (°C)", y="Densidad")
plot(density(Chlorella_mod$CO2), main = "Figura 15. Función de densidad para la variable CO2 (mg/ml))", y="Densidad")
plot(density(Chlorella_mod$OD), main = "Figura 16. Función de densidad para la variable Oxígeno disuelto (mg/ml)", y="Densidad")

plot(ecdf(Chlorella_mod$Densidad), main = "Figura 17. Función de probabilidad acumulada para la variable Densidad (cel/ml)")
plot(ecdf(Chlorella_mod$TCS), main = "Figura 18. Función de probabilidad acumulada para la variable Tasa de Crecimiento Simple")
plot(ecdf(Chlorella_mod$Temperatura), main = "Figura 19. Función de probabilidad acumulada para la variable Temperatura")
plot(ecdf(Chlorella_mod$CO2), main = "Figura 20. Función de probabilidad acumulada para la variable CO2")
plot(ecdf(Chlorella_mod$OD), main = "Figura 21. Función de probabilidad acumulada para la variable Oxígeno Disuelto")

```
