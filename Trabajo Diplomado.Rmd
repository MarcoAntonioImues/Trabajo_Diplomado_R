---
title: "TRABAJO DIPLOMADO - Análisis Exploratorio"
author: "Marco Antonio Imués Figueroa"
date: `r format(Sys.time(), '%d %B %Y')`"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo =TRUE)

library(stats)
library(ggplot2)
library(psych)
library (readxl)

```

## *Variación de las variables de estudio*

# Presentación de tablas de datos

```{r setup}
Chlorella <- read_excel("Chlorella.xlsx", na="NA")
Chlorella$FBR <- as.factor(Chlorella$FBR)
Chlorella$Ciclo <- as.factor(Chlorella$Ciclo)
Chlorella$Dias <- as.factor(Chlorella$Dias)
Chlorella$Muestra <- as.factor(Chlorella$Muestra)
summary(Chlorella)
str(Chlorella)
table(Chlorella$FBR)
table(Chlorella$Ciclo)
table(Chlorella$Dias)
table(Chlorella$Muestra)
```

# Exploración gráfica: Histogramas

```{r setup, include=TRUE}
Chlorella <- data.frame(Chlorella)
ggplot(Chlorella, aes(x=Densidad)) +
  geom_histogram(aes(color=FBR), bins=10) + 
  labs(title = "Figura 1. Densidad celular (cel/ml)", y="Frecuencia")

ggplot(Chlorella, aes(x=TCS)) +
  geom_histogram(aes(color=FBR), bins=6, na.rm = TRUE) +
  labs(title = "Figura 2. Tasa de crecimiento simple (TCS)", y="Frecuencia")

ggplot(Chlorella, aes(x=Temperatura)) +
  geom_histogram(aes(color=FBR), bins=10) +
  labs(title = "Figura 3. Temperatura promedio diario (°C)", y="Frecuencia")

ggplot(Chlorella, aes(x=CO2)) +
  geom_histogram(aes(color=FBR), bins=10) +
  labs(title = "Figura 4. CO2 (mg/L)", y="Frecuencia")

ggplot(Chlorella, aes(x=OD)) +
  geom_histogram(aes(color=FBR), bins=10) +
  labs(title = "Figura 5. Oxígeno disuelto (mg/L)", y="Frecuencia")
```

# Exploración gráfica: Diagrama de cajas y bigotes

```{r setup, include=TRUE}
ggplot(Chlorella, aes(x=FBR, y=Densidad)) +
  geom_boxplot(aes(fill=Ciclo)) +
  labs(title = "Figura 6. Densidad (cel/ml) agrupado por FBR y Ciclo", y="Densidad (cel/ml)")

ggplot(Chlorella, aes(x=FBR, y=TCS)) +
  geom_boxplot(aes(fill=Ciclo), na.rm=TRUE) +
  labs(title = "Figura 7. Tasa de crecimiento simple (TCS) agrupado por FBR y Ciclo", y="TCS")

ggplot(Chlorella, aes(x=FBR, y=Temperatura)) +
  geom_boxplot(aes(fill=Ciclo)) +
  labs(title = "Figura 8. Temperatura (°C) agrupado por FBR y Ciclo", y="Temperatura (°C)")

ggplot(Chlorella, aes(x=FBR, y=CO2)) +
  geom_boxplot(aes(fill=Ciclo)) +
  labs(title = "Figura 9. CO2 (mg/L) agrupado por FBR y Ciclo", y="CO2 (mg/L)")

ggplot(Chlorella, aes(x=FBR, y=OD)) +
  geom_boxplot(aes(fill=Ciclo)) +
  labs(title = "Figura 10. Oxígeno disuelto (mg/L) agrupado por FBR y Ciclo", y="OD (mg/L)")

```

# Exploración gráfica: Distribución y relación entre variables

```{r setup, include=TRUE}
ggplot(Chlorella, aes(x=Temperatura, y=Densidad)) +
  geom_point(aes(color=FBR)) +
  geom_smooth(span=0.2) +
  labs(title = "Figura 11. Relación entre Temperatura (°C) y Densidad (cel/ml) agrupadas por FBR")

ggplot(Chlorella, aes(x=CO2, y=Densidad)) +
  geom_point(aes(color=FBR)) +
  geom_smooth(span=0.2) +
  labs(title = "Figura 12. Relación entre CO2 (mg/L) y Densidad (cel/ml) agrupadas por FBR")

ggplot(Chlorella, aes(x=OD, y=Densidad)) +
  geom_point(aes(color=FBR)) +
  geom_smooth(span=0.2) +
  labs(title = "Figura 13. Relación entre Oxígeno disuelto (mg/l) y Densidad (cel/ml) agrupadas por FBR")

```

# Exploración gráfica: Función de densidad y Función de probabilidad acumulada

```{r setup, include=TRUE}
plot(density(Chlorella$Densidad), main = "Figura 13. Función de densidad para la variable Densidad (cel/ml)", y="Densidad")
plot(density(Chlorella$Temperatura), main = "Figura 14. Función de densidad para la variable Temperatura (°C)", y="Densidad")
plot(density(Chlorella$CO2), main = "Figura 15. Función de densidad para la variable CO2 (mg/ml))", y="Densidad")
plot(density(Chlorella$OD), main = "Figura 16. Función de densidad para la variable Oxígeno disuelto (mg/ml)", y="Densidad")

plot(ecdf(Chlorella$Densidad), main = "Figura 17. Función de probabilidad acumulada para la variable Densidad (cel/ml)")
plot(ecdf(Chlorella$TCS), main = "Figura 18. Función de probabilidad acumulada para la variable Tasa de Crecimiento Simple")
plot(ecdf(Chlorella$Temperatura), main = "Figura 19. Función de probabilidad acumulada para la variable Temperatura")
plot(ecdf(Chlorella$CO2), main = "Figura 20. Función de probabilidad acumulada para la variable CO2")
plot(ecdf(Chlorella$OD), main = "Figura 21. Función de probabilidad acumulada para la variable Oxígeno Disuelto")

```
